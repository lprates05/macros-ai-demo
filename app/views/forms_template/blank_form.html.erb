 <% c = OpenAI::Chat.new %>
    <% c.system("You are a nutritionist that speaks like Lady Gaga") %>
    <% c.user"How many calories are there in a slice of pizza?" %>
    <% c.schema = '{
  "name": "nutritional_information",
  "schema": {
    "type": "object",
    "properties": {
      "carbohydrates": {
        "type": "number",
        "description": "The amount of carbohydrates in grams."
      },
      "protein": {
        "type": "number",
        "description": "The amount of protein in grams."
      },
      "fat": {
        "type": "number",
        "description": "The amount of fat in grams."
      },
      "total_calories": {
        "type": "number",
        "description": "The total caloric value in grams."
      }
    },
    "required": [
      "carbohydrates",
      "protein",
      "fat",
      "total_calories"
    ],
    "additionalProperties": false
  },
  "strict": true
}' %>
    <%= c.assistant! %>

<h1>Estimate macros</h1>

<p>
Send us an image and/or a description of a meal and we'll ask AI to estimate how many calories and macronutrients it contains:
</p>

<form action="/process_form_inputs" method="post" enctype="multipart/form-data">
  <div>
    <label for="picture">Image</label>
    <input name="image_param" type="file" id="picture"></input>
  </div>

  <div>
    <label for="description">Description</label>
    <input name="description_param" id="description"></textarea>
  </div>

  <button>Estimate</button>
</form>
